<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Roc Toolkit internal modules: roc_audio/profiler.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon80.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Roc Toolkit internal modules
   </div>
   <div id="projectbrief">Roc Toolkit: real-time audio streaming</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('profiler_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<div class="title">profiler.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Profiler.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="frame_8h_source.html">roc_audio/frame.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sample__spec_8h_source.html">roc_audio/sample_spec.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="array_8h_source.html">roc_core/array.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="iarena_8h_source.html">roc_core/iarena.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="list_8h_source.html">roc_core/list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="noncopyable_8h_source.html">roc_core/noncopyable.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rate__limiter_8h_source.html">roc_core/rate_limiter.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="time_8h_source.html">roc_core/time.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="units_8h_source.html">roc_packet/units.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for profiler.h:</div>
<div class="dyncontent">
<div class="center"><img src="profiler_8h__incl.png" border="0" usemap="#aroc__audio_2profiler_8h" alt=""/></div>
<map name="aroc__audio_2profiler_8h" id="aroc__audio_2profiler_8h">
<area shape="rect" title="Profiler." alt="" coords="2771,5,2917,32"/>
<area shape="rect" href="frame_8h.html" title="Audio frame." alt="" coords="2774,80,2914,107"/>
<area shape="rect" href="sample__spec_8h.html" title="Sample specifications." alt="" coords="2457,155,2644,181"/>
<area shape="rect" href="noncopyable_8h.html" title="Non&#45;copyable object." alt="" coords="1960,767,2136,793"/>
<area shape="rect" href="array_8h.html" title="Dynamic array." alt="" coords="392,453,517,480"/>
<area shape="rect" href="iarena_8h.html" title="Memory arena interface." alt="" coords="179,535,314,562"/>
<area shape="rect" href="time_8h.html" title="Time definitions." alt="" coords="3192,617,3315,644"/>
<area shape="rect" href="units_8h.html" title="Various units used in packets." alt="" coords="3091,229,3231,256"/>
<area shape="rect" href="list_8h.html" title="Intrusive doubly&#45;linked list." alt="" coords="2666,453,2779,480"/>
<area shape="rect" href="rate__limiter_8h.html" title="Rate limiter." alt="" coords="2167,453,2335,480"/>
<area shape="rect" href="sample_8h.html" title="Audio sample." alt="" coords="2664,229,2813,256"/>
<area shape="rect" href="sample__format_8h.html" title="Sample format." alt="" coords="2073,304,2273,331"/>
<area shape="rect" href="stddefs_8h.html" title="Commonly used types and functions." alt="" coords="2560,841,2701,868"/>
<area shape="rect" href="pcm__format_8h.html" title="PCM format." alt="" coords="543,379,723,405"/>
<area shape="rect" title=" " alt="" coords="1987,916,2072,943"/>
<area shape="rect" title=" " alt="" coords="2097,916,2159,943"/>
<area shape="rect" title=" " alt="" coords="2184,916,2243,943"/>
<area shape="rect" title=" " alt="" coords="2267,916,2317,943"/>
<area shape="rect" title=" " alt="" coords="2341,916,2411,943"/>
<area shape="rect" title=" " alt="" coords="2435,916,2522,943"/>
<area shape="rect" title=" " alt="" coords="2546,916,2617,943"/>
<area shape="rect" title=" " alt="" coords="2641,916,2716,943"/>
<area shape="rect" title=" " alt="" coords="2740,916,2815,943"/>
<area shape="rect" title=" " alt="" coords="2839,916,2910,943"/>
<area shape="rect" title=" " alt="" coords="2935,916,3001,943"/>
<area shape="rect" title=" " alt="" coords="3026,916,3097,943"/>
<area shape="rect" title=" " alt="" coords="3121,916,3191,943"/>
<area shape="rect" title=" " alt="" coords="3216,916,3312,943"/>
<area shape="rect" href="channel__set_8h.html" title="Channel set." alt="" coords="2461,229,2640,256"/>
<area shape="rect" href="string__builder_8h.html" title="String builder." alt="" coords="2297,304,2479,331"/>
<area shape="rect" href="attributes_8h.html" title="Compiler attributes." alt="" coords="130,767,286,793"/>
<area shape="rect" href="channel__defs_8h.html" title="Channel layout, order, and positions." alt="" coords="2829,379,3016,405"/>
<area shape="rect" href="macro__helpers_8h.html" title="Helper macros." alt="" coords="2379,767,2568,793"/>
<area shape="rect" href="optional_8h.html" title="Optionally constructed object." alt="" coords="643,617,789,644"/>
<area shape="rect" href="string__buffer_8h.html" title="String buffer." alt="" coords="747,379,922,405"/>
<area shape="rect" href="aligned__storage_8h.html" title="Aligned storage." alt="" coords="448,692,645,719"/>
<area shape="rect" href="panic_8h.html" title="Panic." alt="" coords="669,692,797,719"/>
<area shape="rect" href="align__ops_8h.html" title="Alignment operations." alt="" coords="704,767,859,793"/>
<area shape="rect" title=" " alt="" coords="170,841,246,868"/>
<area shape="rect" href="log_8h.html" title="Logging." alt="" coords="1250,535,1363,562"/>
<area shape="rect" title=" " alt="" coords="924,767,1092,793"/>
<area shape="rect" title=" " alt="" coords="991,617,1166,644"/>
<area shape="rect" href="mutex_8h.html" title="Mutex." alt="" coords="1293,617,1427,644"/>
<area shape="rect" href="singleton_8h.html" title="Singleton." alt="" coords="814,617,967,644"/>
<area shape="rect" title=" " alt="" coords="1083,692,1151,719"/>
<area shape="rect" title=" " alt="" coords="873,692,957,719"/>
<area shape="rect" href="atomic_8h.html" title="Atomic." alt="" coords="1176,692,1315,719"/>
<area shape="rect" href="errno__to__str_8h.html" title="Convert errno to string." alt="" coords="1491,692,1661,719"/>
<area shape="rect" href="scoped__lock_8h.html" title="RAII mutex lock." alt="" coords="1685,692,1859,719"/>
<area shape="rect" title=" " alt="" coords="1167,767,1324,793"/>
<area shape="rect" href="list__impl_8h.html" title="Intrusive doubly&#45;linked list implementation." alt="" coords="2491,535,2640,562"/>
<area shape="rect" href="list__node_8h.html" title="Linked list node." alt="" coords="2541,617,2693,644"/>
<area shape="rect" href="ownership__policy_8h.html" title="Ownership policies." alt="" coords="2715,528,2863,569"/>
<area shape="rect" href="ticker_8h.html" title="Ticker." alt="" coords="2187,535,2315,562"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="profiler_8h__dep__incl.png" border="0" usemap="#aroc__audio_2profiler_8hdep" alt=""/></div>
<map name="aroc__audio_2profiler_8hdep" id="aroc__audio_2profiler_8hdep">
<area shape="rect" title="Profiler." alt="" coords="577,5,723,32"/>
<area shape="rect" href="profiling__reader_8h.html" title="Profiling reader." alt="" coords="40,80,183,121"/>
<area shape="rect" href="profiling__writer_8h.html" title="Profiling writer." alt="" coords="1008,80,1151,121"/>
<area shape="rect" href="roc__pipeline_2config_8h.html" title="Pipeline config." alt="" coords="572,87,728,114"/>
<area shape="rect" href="receiver__source_8h.html" title="Receiver source pipeline." alt="" coords="209,527,368,568"/>
<area shape="rect" href="transcoder__source_8h.html" title="Transcoder source pipeline." alt="" coords="24,169,199,211"/>
<area shape="rect" href="receiver__loop_8h.html" title="Receiver pipeline loop." alt="" coords="209,616,368,657"/>
<area shape="rect" href="basic__control__endpoint_8h.html" title="Base class for control endpoints." alt="" coords="531,705,686,747"/>
<area shape="rect" href="receiver_8h.html" title="Receiver node." alt="" coords="447,1033,597,1060"/>
<area shape="rect" href="receiver__decoder_8h.html" title="Receiver decoder node." alt="" coords="215,1033,423,1060"/>
<area shape="rect" href="control__interface__map_8h.html" title="Control interface map." alt="" coords="422,795,601,836"/>
<area shape="rect" href="control__loop_8h.html" title="Control loop thread." alt="" coords="625,802,787,829"/>
<area shape="rect" href="context_8h.html" title="Node context." alt="" coords="590,884,737,911"/>
<area shape="rect" href="node_8h.html" title="Base class for nodes." alt="" coords="565,959,695,985"/>
<area shape="rect" href="sender_8h.html" title="Sender node." alt="" coords="621,1033,761,1060"/>
<area shape="rect" href="sender__encoder_8h.html" title="Sender encoder node." alt="" coords="785,1033,984,1060"/>
<area shape="rect" href="sender__sink_8h.html" title="Sender sink pipeline." alt="" coords="767,348,917,389"/>
<area shape="rect" href="transcoder__sink_8h.html" title="Transcoder sink pipeline." alt="" coords="992,169,1167,211"/>
<area shape="rect" href="sender__loop_8h.html" title="Sender pipeline loop." alt="" coords="767,616,917,657"/>
<area shape="rect" href="receiver__endpoint_8h.html" title="Receiver endpoint pipeline." alt="" coords="533,259,692,300"/>
<area shape="rect" href="receiver__session_8h.html" title="Receiver session pipeline." alt="" coords="351,169,509,211"/>
<area shape="rect" href="sender__session_8h.html" title="Sender session." alt="" coords="717,169,866,211"/>
<area shape="rect" href="sender__slot_8h.html" title="Sender slot." alt="" coords="767,259,917,300"/>
<area shape="rect" href="receiver__session__group_8h.html" title="Receiver session group." alt="" coords="351,348,509,389"/>
<area shape="rect" href="receiver__slot_8h.html" title="Receiver slot." alt="" coords="351,437,509,479"/>
<area shape="rect" href="receiver__session__router_8h.html" title="Receiver session router." alt="" coords="351,259,509,300"/>
</map>
</div>
</div>
<p><a href="profiler_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structroc_1_1audio_1_1ProfilerConfig.html">roc::audio::ProfilerConfig</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classroc_1_1audio_1_1Profiler.html" title="Profiler The role of the profiler is to report the average processing speed (# of samples processed p...">Profiler</a> Configuration Parameters. Controls profiling interval and duration of each circular buffer chunk.  <a href="structroc_1_1audio_1_1ProfilerConfig.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classroc_1_1audio_1_1Profiler.html">roc::audio::Profiler</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classroc_1_1audio_1_1Profiler.html" title="Profiler The role of the profiler is to report the average processing speed (# of samples processed p...">Profiler</a> The role of the profiler is to report the average processing speed (# of samples processed per time unit) during the last N seconds. We want to calculate the average processing speed efficiently (with O(1) complexity, without allocations, and as lightweight as possible). The problems with this are that we have variable-sized frames and SMA requires fixed-size chunks. To efficiently perform this calculation a ring buffer is employed. The idea behind the ring buffer is that each chunk of the buffer is the average speed of 10ms worth of samples. The ring buffer is initialized with fixed size (N * 1000)ms / (10ms) chunks. Within each chunk a weighted mean is used to calculate the average speed during those 10ms. Each frame will contribute a different number of samples to each chunk, the chunk speed is then weighted based on how many samples are contributed at what frame speed. As the chunks get populated the moving average is calculated. When the buffer is not entirely full the cumulative moving average algorithm is used and once the buffer is full the simple moving average algorithm is used.  <a href="classroc_1_1audio_1_1Profiler.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceroc"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroc.html">roc</a></td></tr>
<tr class="memdesc:namespaceroc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Root namespace. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceroc_1_1audio"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceroc_1_1audio.html">roc::audio</a></td></tr>
<tr class="memdesc:namespaceroc_1_1audio"><td class="mdescLeft">&#160;</td><td class="mdescRight">Audio frames and audio processing. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Profiler. </p>

<p class="definition">Definition in file <a class="el" href="profiler_8h_source.html">profiler.h</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_0e3e23087e2fde78e6bc891311050c8d.html">roc_audio</a></li><li class="navelem"><a class="el" href="profiler_8h.html">profiler.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
